@(languagelist: List[dto.SimpleLanguage],langaugeidselected: Integer,categorylist: List[dto.product.CategoryWebsiteWithName])@helper.javascriptRouter("categoryRoutes")(	controllers.manager.routes.javascript.Category.getCategoryList,	controllers.manager.routes.javascript.Category.categoryEdit,	controllers.manager.routes.javascript.Category.getCategoryAttributeManager)@views.html.manager.main {<div class="container-fluid">				<!-- BEGIN PAGE HEADER-->				<div class="row-fluid">					<div class="span12">						<!-- BEGIN STYLE CUSTOMIZER -->						<div class="color-panel hidden-phone">							<div class="color-mode-icons icon-color"></div>							<div class="color-mode-icons icon-color-close"></div>							<div class="color-mode">								<p>THEME COLOR</p>								<ul class="inline">									<li class="color-black current color-default" data-style="default"></li>									<li class="color-blue" data-style="blue"></li>									<li class="color-brown" data-style="brown"></li>									<li class="color-purple" data-style="purple"></li>									<li class="color-grey" data-style="grey"></li>									<li class="color-white color-light" data-style="light"></li>								</ul>								<label>									<span>Layout</span>									<select class="layout-option m-wrap small">										<option value="fluid" selected="">Fluid</option>										<option value="boxed">Boxed</option>									</select>								</label>								<label>									<span>Header</span>									<select class="header-option m-wrap small">										<option value="fixed" selected="">Fixed</option>										<option value="default">Default</option>									</select>								</label>								<label>									<span>Sidebar</span>									<select class="sidebar-option m-wrap small">										<option value="fixed">Fixed</option>										<option value="default" selected="">Default</option>									</select>								</label>								<label>									<span>Footer</span>									<select class="footer-option m-wrap small">										<option value="fixed">Fixed</option>										<option value="default" selected="">Default</option>									</select>								</label>							</div>						</div>						<!-- END BEGIN STYLE CUSTOMIZER -->  						<!-- BEGIN PAGE TITLE & BREADCRUMB-->						<h3 class="page-title">							品类管理 <small></small>						</h3>						<ul class="breadcrumb">							<li>								<i class="icon-home"></i>								<a href="index.html">Home</a> 								<i class="icon-angle-right"></i>							</li>							<li>								<a href="@controllers.manager.routes.Category.categoryManager()">品类管理</a>								<i class="icon-angle-right"></i>							</li>						</ul>						<!-- END PAGE TITLE & BREADCRUMB-->					</div>				</div>				<div class="btn-group">					<button id="add_btn" class="btn green" data-toggle="modal" data-target="#add-one-category-modal">						增加品类 <i class="icon-plus"></i>					</button>				</div>				<div class="row-fluid" style="margin-left:50px;margin-top:20px;">					<div class="span4">					    <label for="websiteid">站点选择</label>						@services.manager.ChooseService.getInstance().website("websiteid", null, true)					</div>					<div class="span4">					    <label class="control-label">语言</label>						@services.manager.ChooseService.getInstance().language("languageid", -1)					</div>					<!-- <div class="span2">						 <button type="submit" id="submitChoose" class="btn btn-primary">确定</button>					</div> -->				</div>				<div class="row-fluid">					<div class="span3">						<div id="categorytree">					  		<div id="categorytree_modle">					  		</div>				  	 	</div>				   </div>				   <div class="span9">				   		<div id="categoryedit">							<div id="category_manager_choose" hidden="true" style="display: none; position:relative">								<div class="row-fluid" style="position: fixed;width: 400px;top: 320px;z-index: 99;left: 50%;margin-left: -145px !important;">									<div class="span3">										<button type="submit" id="category_message_manager" class="btn btn-primary">品类信息管理</button>									</div>									<div class="span3">										<button type="submit" id="category_attribute_manager" class="btn btn-primary">品类属性管理</button>									</div>								</div>					  		</div>					  		<div id="categoryedit_modle">					  		</div>						</div>				   </div>				</div><form action="addroot" id="addForm" method="post"><div id="add-one-category-modal" style="width: 800px;top:25%;" class="modal hide fade"	tabindex="-1" role="dialog" aria-labelledby="myModalLabel"	aria-hidden="true">	<div class="modal-header">		<button type="button" class="close" data-dismiss="modal"			aria-hidden="true"></button>		<h3 id="myModalLabel">增加品类</h3>	</div>	<div class="modal-body">		<div style="margin-left: 0px;float: left;">			站点选择 @services.manager.ChooseService.getInstance().website("siteid", 1, true)		</div>		<div id="category1" style="margin-left: 15px; float: left; margin-right: 15px;">			一级品类			<div class="controls">			<select id="parentid" name="parentid" onchange="searchCategory()">				<option value="0" ></option> 						@for( i<- categorylist){							<option value="@i.getIcategoryid">@i.getCname()</option> 					}			</select>			</div>		</div>		<div id="category2" style="display: none;">			二级品类			<div class="controls">			<select id="parentid2" name="parentid2" >				<option value="0" ></option> 				</select>			</div>		</div>		<!-- BEGIN PAGE CONTENT-->				<div class="row-fluid">					<div class="span12" >					<div><span style="color: red;"> 英语必填*  Save时若其他语言没有填写则默认为英语所填的</span></div>						<div class="tabbable tabbable-custom boxless">							<ul class="productDescription_navigation">							</ul>							<ul class="nav nav-tabs">									@for(e <- languagelist){										<li @if(langaugeidselected==e.getIid()){class="active"}><a href="#tab_@e.getIid()" data-toggle="tab">@e.getCname()</a></li>									}							</ul>							<div class="tab-content" style="padding-top: 0px;">								@for(e <- languagelist){									<div class="tab-pane @if(langaugeidselected==e.getIid()){active}" id="tab_@e.getIid()">										<div class="portlet box blue">											<div class="portlet-body form">												<div style="margin-top: 15px;"><span style="display: inline-block; width: 100px;">@e.getCname()类别名称</span><input name="cname@e.getIid()" id="cname_@e.getIid()"/></div>												<div style="margin-top: 15px;"><span style="display: inline-block; width: 100px;">HTML的标题 </span><input name="ctitle@e.getIid()" id="ctitle_@e.getIid()"/></div>											</div>										</div>									</div>									}								<div id="namemsg"></div>							</div>						</div>					</div>				</div>				<!-- END PAGE CONTENT --></div> 	<div id="modal-footer" class="modal-footer" style="margin-bottom: -20px;">		<div class="btn blue" onclick="valid()" id="categorySave">Save</div>		<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>	</div></div></form> </div>@services.base.HtmlUtils.misc().addTailOnce{	<script src="@controllers.manager.routes.Assets.at("lib/requirejs/require.js")" data-main="@controllers.manager.routes.Assets.at("js/manager/categorydetail")" ></script>	<script type="text/javascript">		function valid(){			var cname=$("#cname_1").val();			var ctitle=$("#ctitle_1").val();				if($.trim(cname)==""){				alert("please input en cname");				return false;			}			if($.trim(ctitle)==""){				alert("please input en ctitle");				return false;			}			var parentid = $("#parentid").val();			var parentid2 = $("#parentid2").val();			var siteid = $("#siteid").val(); 						var url = '@controllers.manager.routes.Category.checkCpath(null)';			url += "?cname=" + cname + "&parentid=" + parentid + "&parentid2=" + parentid2+ "&siteId=" + siteid;			$("#categorySave").prop("disabled",true);			$.ajax({url: url, 				type: 'get', 				dataType: 'json', 				timeout: 10000, 				error: function(){					$("#categorySave").prop("disabled",false);					alert('Error publish');				}, 				success: function(res){					$("#categorySave").prop("disabled",false);				     $.each(res,function(key,value) {				    	 if(key == -1){				    		 $("#namespan").remove();							 $("#namemsg").append("<span id='namespan' style='color: red;'>此站点类别名称已存在</span>");				    	 }else{				    		 $('#addForm').submit();				    	 }				     });				}			})		}				function searchCategory(){			$("#category2").css('display','none'); 		    $("#parentid2 option").remove();			$("#parentid2").append("<option value='0'></option>");			var c1=$("#parentid").val();			var siteid=$("#siteid").val();				if(c1 != "-1"){				var url =  '@controllers.manager.routes.CategoryRecommend.childCategory(0)';				url += "?categoryid=" +c1 + "&siteid=" + siteid;				$.ajax({url: url, 					type: 'get', 					dataType: 'json', 					timeout: 1000, 					error: function(){alert('Error publish');}, 					success: function(res){						 var b = 0;					     $.each(res,function(key,value) {					    	 if(key == -1){					    		 b = key;					    	 }else{					    	 	$("#parentid2").append("<option value='"+key+"'>"+value+"</option>");					    	 }					     	});					     if(b == 0){					     	$("#category2").css('display','inline-block'); 					     }						} 					})			}		}		$('#siteid').change(function(){			searchChangeSite();		});		function searchChangeSite(){			$("#category1").css('display','none'); 			$("#category2").css('display','none'); 			$("#parentid option").remove();		    $("#parentid2 option").remove();		    $("#parentid").append("<option value='0'></option>");		    $("#parentid2").append("<option value='0'></option>");			var siteid=$("#siteid").val();			if(siteid != ""){				var url =  '@controllers.manager.routes.CategoryRecommend.rootCategory(0)';				url += "?siteid=" + siteid;				$.ajax({url: url, 					type: 'get', 					dataType: 'json', 					timeout: 1000, 					error: function(){alert('Error publish');}, 					success: function(res){					     $.each(res,function(key,value) {					    	 if(key != -1){					    		 $("#parentid").append("<option value='"+key+"'>"+value+"</option>");					    	 }					     	});					     $("#category1").css('display','inline-block'); 						}					})			}		}	</script>}  }
